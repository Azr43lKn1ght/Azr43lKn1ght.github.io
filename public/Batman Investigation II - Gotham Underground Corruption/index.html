<!doctype html>
<html class="scroll-smooth" lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      id="viewport"
      content="width=device-width, initial-scale=1.0" />
    <title>
      Batman Investigation II - Gotham Underground Corruption bi0sCTF 2024 Writeup | Azr43lkn1ght
    </title><meta name="application-name" content="Azr43lkn1ght" />
<meta name="apple-mobile-web-app-title" content="Azr43lkn1ght" />


  <meta name="title" content="Batman Investigation II - Gotham Underground Corruption bi0sCTF 2024 Writeup" />



  <meta name="description" content="Full solution of Batman Investigation II - Gotham Underground Corruption from bi0sctf 2024" />
<meta name="theme-color" content="#ffffff" /><link rel="icon" href="/hellbat.png" /><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" /><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff" />




  
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/instantsearch.css@8.0.0/themes/reset-min.css"
    integrity="sha256-2AeJLzExpZvqLUxMfcs+4DWcMwNfpnjUeAAvEtPr0wU="
    crossorigin="anonymous" />

  
  
  
  <link href="/css/search.css" rel="stylesheet" />











<link href="/css/styles.css" rel="stylesheet" />

<link href="/css/custom.css" rel="stylesheet" />
  
  
  
  <link href="/css/image-preview.css" rel="stylesheet" />

  
    
    
    
    <link href="/css/syntax.css" rel="stylesheet" />
  
<script src="/js/third-party/flowbite/v2.2.1/flowbite.min.js" defer></script>
<script>
  
  if (
    localStorage.getItem("color-theme") === "dark" ||
    (!("color-theme" in localStorage) &&
      window.matchMedia("(prefers-color-scheme: dark)").matches)
  ) {
    document.documentElement.classList.add("dark");
  } else {
    document.documentElement.classList.remove("dark");
  }
</script>

  </head>
  <body class="flex h-screen flex-col bg-white dark:bg-[#1b1f26]"><nav
  id="navbar"
  class="fixed start-0 top-0 z-20 flex w-full justify-center border-b border-gray-200 bg-white/85 backdrop-blur-md md:h-38 dark:border-gray-700 dark:bg-[#1b1f26]">
  <div
    class="mx-auto flex w-[1280px] flex-wrap items-center justify-between place-self-center object-center p-4">
    
    
    <a
      href="http://localhost:1313/"
      class="flex items-center justify-start space-x-3 rtl:space-x-reverse">
      
      <p class="dark:text-primary rounded-full flex gap-3 items-center" style="font-size: 1.3rem">
        <img src="https://raw.githubusercontent.com/Azr43lKn1ght/Azr43lKn1ght/main/h3LL.png" alt="logo" class="h-[50px] rounded-full" />
        <b class="font-mono text-white hover:text-primary">Azr43lKn1ght</b>
      </p></a>
<div class="flex flex-col md:flex-row gap-6">
    
    <div class="flex items-center space-x-3 md:order-2 rtl:space-x-reverse">
      
      
        <button
          type="button"
          id="search-icon"
          class="bg-primary p-3 text-center text-sm font-medium text-white hover:bg-[#069096] focus:outline-none md:p-5 dark:bg-primary dark:hover:bg-[#069096]">
          <svg
            t="1702210633165"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="4364"
            width="16"
            height="16">
            <path
              d="M426.666667 768a339.285333 339.285333 0 0 0 208.938666-72.021333l187.562667 187.562666 60.330667-60.330666-187.562667-187.562667A339.285333 339.285333 0 0 0 768 426.666667c0-188.202667-153.130667-341.333333-341.333333-341.333334s-341.333333 153.130667-341.333334 341.333334 153.130667 341.333333 341.333334 341.333333z m0-597.333333c141.184 0 256 114.816 256 256s-114.816 256-256 256-256-114.816-256-256 114.816-256 256-256z"
              fill="#ffffff"
              p-id="4365"></path>
          </svg>
        </button>
      

      
      <button
        data-collapse-toggle="navbar-sticky"
        type="button"
        class="inline-flex h-10 w-10 items-center justify-center p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none md:hidden dark:text-gray-400 dark:hover:bg-gray-700"
        aria-controls="navbar-sticky"
        aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg
          class="h-5 w-5"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 17 14">
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M1 1h15M1 7h15M1 13h15" />
        </svg>
      </button>
    </div>
    <span class="flex items-center absolute md:relative top-[50px] md:top-0 right-0 left-0">
      <div
  class="hidden w-full items-center justify-between md:order-1 md:flex md:w-auto"
  id="navbar-sticky">
  <ul
    class="mt-4 flex flex-col rounded-lg border border-gray-300 p-4 font-medium md:mt-0 md:flex-row md:space-x-8 md:border-0 md:p-0 rtl:space-x-reverse dark:border-gray-700 dark:bg-gray-900 md:dark:bg-transparent">
    
      <li>
        
          <a
            aria-current="page"
            class="block rounded-lg px-3 py-2 text-gray-900 hover:bg-gray-100 md:p-0 md:hover:bg-transparent md:hover:text-[#00adb5] dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent md:dark:hover:text-[#00adb5]"
            href="/">
            
            Home
          </a>
        
      </li>
    
      <li>
        
          <a
            aria-current="page"
            class="block rounded-lg px-3 py-2 text-gray-900 hover:bg-gray-100 md:p-0 md:hover:bg-transparent md:hover:text-[#00adb5] dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent md:dark:hover:text-[#00adb5]"
            href="/posts/">
            
            Posts
          </a>
        
      </li>
    

    
      <button
        id="dropdownNavbarLink-category"
        data-dropdown-toggle="dropdownNavbar-category"
        class="flex w-full items-center justify-between rounded-lg px-3 py-2 text-gray-900 hover:bg-gray-100 md:w-auto md:border-0 md:p-0 md:hover:bg-transparent md:hover:text-[#00adb5] dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 dark:focus:text-white md:dark:hover:bg-transparent md:dark:hover:text-[#00adb5]">
        Category
        <svg
          class="ms-2.5 h-2.5 w-2.5"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 10 6">
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="m1 1 4 4 4-4" />
        </svg>
      </button>

      <div
        id="dropdownNavbar-category"
        class="z-10 hidden w-44 divide-y divide-gray-100 rounded-lg bg-white font-normal shadow dark:divide-gray-600 dark:bg-gray-800">
        <ul
          class="py-2 text-sm text-gray-700 dark:text-gray-400"
          aria-labelledby="dropdownLargeButton">
          
            <li>
              <a
                href="http://localhost:1313/categories/bi0sctf/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >Bi0sCTF</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/ctf-writeups/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >CTF Writeups</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/dfir/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >DFIR</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/malware-analysis/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >Malware Analysis</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/malware-development/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >Malware Development</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/ransomware/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >Ransomware</a
              >
            </li>
          
            <li>
              <a
                href="http://localhost:1313/categories/rootkit-analysis/"
                class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                >Rootkit Analysis</a
              >
            </li>
          
        </ul>
      </div>
    
  </ul>
</div>
</span>
  </div>
  </div>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    let navbarDom = document.getElementById("navbar");
    let isNavScrolled = false;

    if (window.innerWidth >= 768) {
      navbarDom.classList.add("navbar-init");

      var scrollTop = 0;

      window.addEventListener("scroll", function () {
        scrollTop = window.pageYOffset;

        if (scrollTop >= 10 && !isNavScrolled) {
          isNavScrolled = true;
          navbarDom.classList.add("navbar-scroll");
        } else if (scrollTop < 10 && isNavScrolled) {
          isNavScrolled = false;
          navbarDom.classList.remove("navbar-scroll");
        }
      });
    } else {
      navbarDom.classList.remove("navbar-init");
    }
  });
</script>

  

  
  
    
    
      <div id="post-feature" class="mt-22 w-full md:mt-[151px]">
        <img
          class="h-60 w-full object-cover md:h-120"
          src="http://localhost:1313/images/posts/3.jpg"
          alt="preview image"
          srcset="" />
      </div>
    
  


  <div
    id="single-page-container"
    class="mx-auto my-5 w-full rounded-b-lg px-5 md:max-w-6xl">
    <div class="flex w-full justify-between">
      
      <div id="post-container" class="w-full flex-grow">
        
        <div
          id="post-title"
          data-popover-target="popover-animation"
          data-popover-offset="0"
          data-popover-placement="bottom"
          class="flex flex-col py-5 pl-0 pr-1 md:py-8 md:pl-1 md:pr-3 lg:py-10 lg:pl-7 lg:pr-10">
          <div
            class="flex flex-row flex-wrap space-x-1 border-l-8 border-primary pb-2 pl-2 pt-1 font-Oswald text-sm font-normal tracking-wide text-gray-500/90 dark:text-gray-300">
            <span>Posted by March 7 2024</span>

            
            
            
              <span class="flex flex-row space-x-1">
                
                  <span class="text-primary"> / </span>
                  <a
                    class="border-b-2 border-transparent hover:border-b-2 hover:border-primary hover:text-[#00adb5]"
                    href="http://localhost:1313/categories/malware-analysis/"
                    >Malware Analysis</a
                  >
                
                  <span class="text-primary"> / </span>
                  <a
                    class="border-b-2 border-transparent hover:border-b-2 hover:border-primary hover:text-[#00adb5]"
                    href="http://localhost:1313/categories/dfir/"
                    >DFIR</a
                  >
                
                  <span class="text-primary"> / </span>
                  <a
                    class="border-b-2 border-transparent hover:border-b-2 hover:border-primary hover:text-[#00adb5]"
                    href="http://localhost:1313/categories/bi0sctf/"
                    >Bi0sCTF</a
                  >
                
                  <span class="text-primary"> / </span>
                  <a
                    class="border-b-2 border-transparent hover:border-b-2 hover:border-primary hover:text-[#00adb5]"
                    href="http://localhost:1313/categories/ctf-writeups/"
                    >CTF Writeups</a
                  >
                
              </span>
            

          </div>
          <div
            class="border-l-8 border-primary py-1 pl-2 text-start text-3xl font-bold tracking-wide text-black lg:text-4xl dark:text-white">
            Batman Investigation II - Gotham Underground Corruption bi0sCTF 2024 Writeup
          </div>

          <div
            class="flex flex-row flex-wrap items-center space-x-1 border-l-8 border-primary pb-1 pl-2 pt-3.5 font-Oswald text-xs font-extralight tracking-wide text-gray-500/90 dark:text-gray-300">
            <span>Updated on April 16 2024</span>
            <div
              class="h-1 w-1 rounded-full bg-primary"></div>
            <span>4934 words</span>
            <div
              class="h-1 w-1 rounded-full bg-primary"></div>
            <span>24 minutes read</span>
            
              <div
                class="h-1 w-1 rounded-full bg-primary"></div>
              <p>
                <span
                  id="twikoo_visitors"
                  class="page-info-pageview-count"
                  data-path="/Batman%20Investigation%20II%20-%20Gotham%20Underground%20Corruption/"
                  >...</span
                >
                visits
              </p>
            
          </div>
        </div>

        
        <div
          id="single-content"
          class="format mx-auto max-w-none px-1 py-5 md:format-base dark:format-invert format-figure:flex format-figure:flex-col format-figure:items-center format-img:cursor-zoom-in md:px-3 lg:px-10 dark:text-gray-300">
          <p><strong>Challenge Points</strong>: 1000</p>
<p><strong>No. of solves</strong>: 0</p>
<p><strong>Challenge Author</strong>: 
<a
  href="https://twitter.com/Azr43lKn1ght"
  
    target="_blank"
  
  >Azr43lKn1ght</a
>
</p>
<h3 class="group head-tag" id="challenge-description">Challenge Description<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#challenge-description"></a></h3><p>After getting in hold of Carmine Falcone&rsquo;s Laptop, Bruce Wayne has to investigate his laptop but unfortnatly he can&rsquo;t get the files nor the encrypted disk and its key, so he went ahead to get the memory dumped. After investigating and getting the data from the guy hired by Falcone for analysis, it seems corrupted!. Now He have to find and solve the things uncovering the Gotham&rsquo;s underground secrets, Help him solve the case of biggest Gotham corruption that is yet to happen!! They need to be stopped!</p>
<p>Password : <strong>freIsEprOMPOLICkLERA</strong></p>
<p><strong>Challenge Files</strong>:</p>
<ul>
<li>
<a
  href="https://drive.google.com/file/d/1Z3TH8qo8SyEZO6UjteakHsekRKoZgE3C/view?usp=sharing"
  
    target="_blank"
  
  >Primary Link</a
>
</li>
<li>
<a
  href="https://mega.nz/file/NnEFCIaJ#hpPcwCBVfR_E_qN4cfHNNzwgCm-hA4vgcehxZ7YABy4"
  
    target="_blank"
  
  >Mirror Link</a
>
</li>
<li>nc link</li>
</ul>
<h3 class="group head-tag" id="solution">Solution<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#solution"></a></h3>
  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<h4 class="group head-tag" id="question-1">Question 1:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-1"></a></h4><p>Q1) who asked Carmine falcon to contact someone and who is falcone disguised as?
Format: disguse-name_person-contacted (all lowercase)</p>
<p>We are given a Raw file which is a memory dump, so we can use volatility to analyze the memory dump. First, we need to find the profile of the memory dump. We can use the <code>imageinfo</code> plugin to find the profile of the memory dump if we are using vol2.</p>
<p>as it was Win10x64_19041, we can either use vol2 or vol3 to analyze the memory dump.</p>
<p>Looking into active process list using windows.pslist.PsList</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> vol -f Carmine-Falcone.raw windows.pslist.PsList
</span></span></code></pre></div><pre tabindex="0"><code>Volatility 3 Framework 2.4.1
Progress:  100.00               PDB scanning finished
PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime      ExitTime       File output

[snip]
3668    748     svchost.exe     0xab0b10473080  2       -       0       False   2024-01-07 17:29:41.000000      N/A    Disabled
3660    748     MsMpEng.exe     0xab0b0e2b8080  44      -       0       False   2024-01-07 17:30:46.000000      N/A    Disabled
7748    896     ShellExperienc  0xab0b125892c0  15      -       1       False   2024-01-07 17:37:19.000000      N/A    Disabled
7824    896     RuntimeBroker.  0xab0b07662080  2       -       1       False   2024-01-07 17:37:19.000000      N/A    Disabled
6528    896     ApplicationFra  0xab0b108ab0c0  1       -       1       False   2024-01-07 17:37:24.000000      N/A    Disabled
1536    748     svchost.exe     0xab0b10d48080  2       -       0       False   2024-01-07 17:37:28.000000      N/A    Disabled
6424    748     NisSrv.exe      0xab0b10d83080  14      -       0       False   2024-01-07 17:41:46.000000      N/A    Disabled
6068    4640    Exodus.exe      0xab0b1259c080  0       -       1       False   2024-01-07 18:08:55.000000      2024-01-07 18:52:34.000000      Disabled
1232    896     Microsoft.Phot  0xab0b0e63f080  16      -       1       False   2024-01-07 18:16:04.000000      N/A    Disabled
5912    896     RuntimeBroker.  0xab0b0e809080  3       -       1       False   2024-01-07 18:16:07.000000      N/A    Disabled
5756    748     svchost.exe     0xab0b12c7d240  3       -       0       False   2024-01-07 18:20:53.000000      N/A    Disabled
5408    896     smartscreen.ex  0xab0b11a28340  9       -       1       False   2024-01-07 19:03:15.000000      N/A    Disabled
8596    2280    audiodg.exe     0xab0b0e63e080  4       -       0       False   2024-01-07 19:03:16.000000      N/A    Disabled
7284    4504    DumpItog.exe    0xab0b1259b080  1       -       1       True    2024-01-07 19:03:18.000000      N/A    Disabled
6576    7284    conhost.exe     0xab0b0e024080  4       -       1       False   2024-01-07 19:03:18.000000      N/A    Disabled
5372    4504    notepad.exe     0xab0b152e8080  4       -       1       False   2024-01-07 19:04:06.000000      N/A    Disabled
2352    8552    Exodus.exe      0xab0b0e2b9080  45      -       1       False   2024-01-07 19:04:23.000000      N/A    Disabled
7260    2352    Exodus.exe      0xab0b0feef080  22      -       1       False   2024-01-07 19:04:23.000000      N/A    Disabled
5616    2352    Exodus.exe      0xab0b117bb080  19      -       1       False   2024-01-07 19:04:23.000000      N/A    Disabled
3972    2352    Exodus.exe      0xab0b10479080  11      -       1       False   2024-01-07 19:04:23.000000      N/A    Disabled
2436    2352    Exodus.exe      0xab0b106b0080  22      -       1       False   2024-01-07 19:04:24.000000      N/A    Disabled
6700    2352    Exodus.exe      0xab0b0d257080  17      -       1       False   2024-01-07 19:04:24.000000      N/A    Disabled
1176    2352    Exodus.exe      0xab0b152ef080  29      -       1       False   2024-01-07 19:04:24.000000      N/A    Disabled
6048    2352    Exodus.exe      0xab0b104d1080  25      -       1       False   2024-01-07 19:04:24.000000      N/A    Disabled
3028    2352    Exodus.exe      0xab0b0773a080  17      -       1       False   2024-01-07 19:04:24.000000      N/A    Disabled
9892    2352    Exodus.exe      0xab0b10c57080  15      -       1       False   2024-01-07 19:04:29.000000      N/A    Disabled
8716    2352    Exodus.exe      0xab0b0f6f6080  17      -       1       False   2024-01-07 19:04:30.000000      N/A    Disabled
7828    2352    Exodus.exe      0xab0b0773f080  17      -       1       False   2024-01-07 19:04:30.000000      N/A    Disabled
3768    4504    KeePass.exe     0xab0b1047f080  8       -       1       False   2024-01-07 19:04:42.000000      N/A    Disabled
1576    4504    7zG.exe 0xab0b07767080  3       -       1       False   2024-01-07 19:05:17.000000      N/A     Disabled
6628    4504    7zFM.exe        0xab0b0e4c9080  4       -       1       False   2024-01-07 19:05:31.000000      N/A    Disabled
7644    4504    thunderbird.ex  0xab0b0765d080  68      -       1       False   2024-01-07 19:05:46.000000      N/A    Disabled
4872    7644    thunderbird.ex  0xab0b12f54080  28      -       1       False   2024-01-07 19:05:46.000000      N/A    Disabled
6248    7644    thunderbird.ex  0xab0b125062c0  30      -       1       False   2024-01-07 19:05:49.000000      N/A    Disabled
5848    2352    Exodus.exe      0xab0b1102e2c0  29      -       1       False   2024-01-07 19:06:13.000000      N/A    Disabled
3960    2352    Exodus.exe      0xab0b13c020c0  16      -       1       False   2024-01-07 19:06:13.000000      N/A    Disabled
6392    5432    SearchProtocol  0xab0b0d3c8080  11      -       0       False   2024-01-07 19:06:21.000000      N/A    Disabled
6172    5432    SearchFilterHo  0xab0b152c2080  7       -       0       False   2024-01-07 19:06:21.000000      N/A    Disabled
56      0               0xab0b108d9080  0       -       -       False   N/A     N/A     Disabled
</code></pre><p>For the messages sent we can see that Thunderbird.exe is an active process. So analysing Inbox file will give us all the conversation data. So lets scan and list all files in the system using</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol -f Carmine-Falcone.raw windows.filescan.FileScan
</span></span></code></pre></div><pre tabindex="0"><code>[snip]
0xab0b10cde210  \Users\Carmine Falcone\AppData\Roaming\Thunderbird\Profiles\ifbixagh.default-release\Mail\pop.gmail.com\Inbox   216
[snip]
</code></pre><p>Lets dump the files from memory using the following command</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol -f Carmine-Falcone.raw windows.dumpfiles.DumpFiles --virtaddr 0xab0b10cde210 
</span></span></code></pre></div><p>let&rsquo;s analyze the file, on analysis on the contents of the file, the answer to the first question is found.</p>
<pre tabindex="0"><code>[snip]
X-Gm-Message-State: AOJu0Yyv8yhr8N0SSfAETgbGKlwAAXHBQ8dPe0iUUHmbk4oykMYSTuoR
   ErKG++vrWZ5uSwIcHfIukc3n4Q98KhcEOA==
X-Google-Smtp-Source: AGHT+IEaR13fr5QwtA2EVAeeqRlt5MHwDILGsc17qMCuDr64g/xiFSQi2/n9+TmXEoQztdSMzBFY3Q==
X-Received: by 2002:a17:902:e54a:b0:1d4:da6d:c121 with SMTP id n10-20020a170902e54a00b001d4da6dc121mr2644778plf.13.1704622743610;
       Sun, 07 Jan 2024 02:19:03 -0800 (PST)
Return-Path: &lt;salvatoremaroni3376@gmail.com&gt;
Received: from [10.0.2.15] ([59.89.233.32])
       by smtp.gmail.com with ESMTPSA id ji5-20020a170903324500b001d3ffb7c4c7sm4214767plb.40.2024.01.07.02.18.49
       for &lt;hugostrange581@gmail.com&gt;
       (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
       Sun, 07 Jan 2024 02:18:59 -0800 (PST)
Content-Type: multipart/mixed; boundary=&#34;------------I30YCObF3eWdYu0uKKgStigo&#34;
Message-ID: &lt;d3a63f93-a0ee-4718-a71a-d9646de2698b@gmail.com&gt;
Date: Sun, 7 Jan 2024 10:17:39 +0000
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Content-Language: en-US
To: hugostrange581@gmail.com
From: Salvatore Maroni &lt;salvatoremaroni3376@gmail.com&gt;
Subject: Confidential!!

This is a multi-part message in MIME format.
--------------I30YCObF3eWdYu0uKKgStigo
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Contact the guy and the key for his reply is his private key!!


--------------I30YCObF3eWdYu0uKKgStigo
Content-Type: application/octet-stream; name=&#34;contact.rar&#34;
Content-Disposition: attachment; filename=&#34;contact.rar&#34;
Content-Transfer-Encoding: base64

UmFyIRoHAQC+0emJDQEFCQAIAQGb1umAgAAblo4KLwIDC+eEAASEwAAgz4NtOoA7ABFjb250
YWN0Ly5EU19TdG9yZQoDAp8i9ZMvP9oBzfZjAjB1QzNC9HBGxzabsqp/ESASvESqR1DS3aIR
UcaXdOB0Nog4aCpZbC2Gyx0sl2iVVSvY34OfBd6nxI+LnITbtzHJBWyyoR1OZu9clcxuvPZj
[snip]
</code></pre><p><code>hugo-strange_salvatore-maroni</code> is the answer to the first question.</p>
<pre tabindex="0"><code>Answer1:hugo-strange_salvatore-maroni
</code></pre><p>but we also found an attachment that was sent with the email. Let&rsquo;s extract the file contact.rar which is the attachment and analyze it as well look into the second question.</p>
<p>but this can also be solved by taking a memory dump of the process and listing all the strings.</p>
<h4 class="group head-tag" id="question-2">Question 2:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-2"></a></h4><p>Q2) what is the hash of the file that he sent him to contact
Format: sha1sum</p>
<p>After decoding the base64 encoded attachment file as well removing all trailing white spaces, we get the attachment file, now we can extract and compute the sha1sum of the attachment.</p>
<pre tabindex="0"><code>Answer2: 61ca5520263677e648297e1aefd90343fdd0388f
</code></pre><h4 class="group head-tag" id="question-3">Question 3:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-3"></a></h4><p>Q3) what is the password of his password manager
Format: password_manager_name_with_version:md5(password)</p>
<p>As we can see KeePass was the only password manager that was running on the system, we can conclude it was the password manager. Now we have to find its version.</p>
<p>From filescan, we can see that KeePass 2.53.1 was present (version : 2.53.1)</p>
<pre tabindex="0"><code>0xab0b10a0f1b0  \Users\Carmine Falcone\Downloads\KeePass-2.53.1-Setup.exe
</code></pre><p>this can also be found from the following config file</p>
<p><code>0xab0b10a3b3f0         \Program Files\KeePass Password Safe 2\KeePass.exe.config	216</code></p>
<p>So i went ahead and dumped <code>KeePass.exe.config</code> and its contents were:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;startup</span> <span class="na">useLegacyV2RuntimeActivationPolicy=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;supportedRuntime</span> <span class="na">version=</span><span class="s">&#34;v4.0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;supportedRuntime</span> <span class="na">version=</span><span class="s">&#34;v2.0.50727&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/startup&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;runtime&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;assemblyBinding</span> <span class="na">xmlns=</span><span class="s">&#34;urn:schemas-microsoft-com:asm.v1&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;dependentAssembly&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;assemblyIdentity</span> <span class="na">name=</span><span class="s">&#34;KeePass&#34;</span>
</span></span><span class="line"><span class="cl">					<span class="na">publicKeyToken=</span><span class="s">&#34;fed2ed7716aecf5c&#34;</span>
</span></span><span class="line"><span class="cl">					<span class="na">culture=</span><span class="s">&#34;neutral&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;bindingRedirect</span> <span class="na">oldVersion=</span><span class="s">&#34;2.0.9.0-2.53.1.0&#34;</span>
</span></span><span class="line"><span class="cl">					<span class="na">newVersion=</span><span class="s">&#34;2.53.1.20815&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;/dependentAssembly&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/assemblyBinding&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;enforceFIPSPolicy</span> <span class="na">enabled=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;loadFromRemoteSources</span> <span class="na">enabled=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/runtime&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;appSettings&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&#34;EnableWindowsFormsHighDpiAutoResizing&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/appSettings&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>as well this can be done by printing the hive registry or dumping hives and analysing the registry.</p>
<p>now we want the password, searching for password recovery/retrieval of the database of KeePass which is .kdbx file, we come across a CVE dated 2023. That is CVE-2023-32784 as well we can find this 
<a
  href="https://www.forensicxlab.com/posts/keepass/"
  
    target="_blank"
  
  >article</a
>
.</p>
<p>Now let&rsquo;s search for .kdbx files using filescan and dump the file from memory.</p>
<pre tabindex="0"><code>[snip]
0xab0b138c5bc0  \Users\Carmine Falcone\Downloads\bruce.kdbx     216
[snip]
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol -f Carmine-Falcone.raw windows.dumpfiles.DumpFiles --virtaddr 0xab0b138c5bc0
</span></span></code></pre></div><p>The plugin we found from the article above shows a missing character in the middle.</p>
<pre tabindex="0"><code>Possible password: ●i&amp;Y●Q)8h&lt;)1T2j
Possible password: ●+&amp;Y●Q)8h&lt;)1T2j
Possible password: ●`&amp;Y●Q)8h&lt;)1T2j
Possible password: ●&#34;&amp;Y●Q)8h&lt;)1T2j
Possible password: ●j&amp;Y●Q)8h&lt;)1T2j
Possible password: ●r&amp;Y●Q)8h&lt;)1T2j
Possible password: ●1&amp;Y●Q)8h&lt;)1T2j
Possible password: ●R&amp;Y●Q)8h&lt;)1T2j
Possible password: ●B&amp;Y●Q)8h&lt;)1T2j
Possible password: ●Q&amp;Y●Q)8h&lt;)1T2j
Possible password: ● &amp;Y●Q)8h&lt;)1T2j
</code></pre><p>So it&rsquo;s better we go with the .net 
<a
  href="https://github.com/vdohney/keepass-password-dumper?tab=readme-ov-file"
  
    target="_blank"
  
  >tool</a
>
 which is better.</p>
<pre tabindex="0"><code>Password candidates (character positions):
Unknown characters are displayed as &#34;●&#34;
1.:	●
2.:	w, |, Q, B, }, j, , Ë, +, , s, ü, r, {, :, d, Ô, §,                                                                                    , ,  , ;, 8, Þ, , F, Á, 1, i, 0, c, u, Ç, , ç, q, Í,  Ö, Ø, !, 5, , è, £, ®, Ñ, `, , , X, 6, È, %, ), Ì, &amp;, &#34;, 	,  , Å, Û, ¨, &#39;, -, @, û, R, , 
                                              , ð, ÷, ý, a, \, 3, t, H, A, Ú, y, ã, Ý, 7, , p, 
3.:	&amp;, 
4.:	Y, 
5.:	é, 
6.:	Q, 
7.:	), 
8.:	8, 
9.:	h, T, 
10.:	&lt;, 
11.:	), 
12.:	1, 
13.:	T, 
14.:	2, 
15.:	j, 
Combined: ●{w, |, Q, B, }, j, , Ë, +, , s, ü, r, {, :, d, Ô, §,                                                                                , ,  , ;, 8, Þ, , F, Á, 1, i, 0, c, u, Ç, , ç, q, Í,  Ö, Ø, !, 5, , è, £, ®, Ñ, `, , , X, 6, È, %, ), Ì, &amp;, &#34;, 	,  , Å, Û, ¨, &#39;, -, @, û, R, , 
                                              , ð, ÷, ý, a, \, 3, t, H, A, Ú, y, ã, Ý, 7, , p}&amp;YéQ)8{h, T}&lt;)1T2j
</code></pre><p>lets write a easy script to bruteforce the password</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pykeepass</span> <span class="kn">import</span> <span class="n">PyKeePass</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;bruce.kdbx&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">charset</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39; &#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dbpass.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">pwds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">count</span> <span class="o">=</span> <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pwds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pwds</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">password</span> <span class="o">=</span> <span class="n">char</span><span class="o">+</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">db</span> <span class="o">=</span> <span class="n">PyKeePass</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Valid password found for </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">password</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">found</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>before that we analyse the kdbx file for a structure check and remove the trailing null bytes added up during filedump.</p>
<p>After running the script on it, we get the correct password:</p>
<pre tabindex="0"><code>[snip]
29/11 : ci&amp;YéQ)8h&lt;)1T2j
Valid password found for bruce.kdbx : di&amp;YéQ)8h&lt;)1T2j
30/11 : di&amp;YéQ)8h&lt;)1T2j
[snip]
</code></pre><p>so the password is <code>di&amp;YéQ)8h&lt;)1T2j</code>
and now the answer will be</p>
<pre tabindex="0"><code>Answer3: keepass_2.53.1:4e896dbb5120c2c33e0965174c6036c2
</code></pre><h4 class="group head-tag" id="question-4">Question 4:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-4"></a></h4><p>Q4) what is the key he stored in his password manager that he deleted?
Format: (format: user_name:key)</p>
<p>now we can open the kdbx file using the password we retrieved.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-1.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>now lets look for the key he stored in his password manager which was deleted.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-2.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>let&rsquo;s view it</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-3.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<pre tabindex="0"><code>Answer4: Azr43lKn1ght:sw1zwJjvpqVvFNANws1v
</code></pre><h4 class="group head-tag" id="question-5">Question 5:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-5"></a></h4><p>Q5) what is the cryptocurrency wallet installed and when is it installed?
Format: wallet_name-date-time(in format YYYY:MM:DD:HH:MM)</p>
<p>We can see from the active processes that Exodus is running, so we can conclude that Exodus is the cryptocurrency wallet installed. Now we have to find the installation time.</p>
<p>From Uninstall reg entry of exodus, we can get the install date</p>
<pre tabindex="0"><code>vol.py -f Carmine-Falcone.raw --profile=Win10x64_19041 printkey -K &#34;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\exodus&#34;   
Volatility Foundation Volatility Framework 2.6.1
Legend: (S) = Stable   (V) = Volatile

----------------------------
Registry: \??\C:\Users\Carmine Falcone\ntuser.dat
Key name: exodus (S)
Last updated: 2024-01-07 08:39:51 UTC+0000

Subkeys:

Values:
REG_SZ        DisplayIcon     : (S) C:\Users\Carmine Falcone\AppData\Local\exodus\app.ico
REG_SZ        DisplayName     : (S) Exodus
REG_SZ        DisplayVersion  : (S) 24.1.1
REG_SZ        InstallDate     : (S) 20240107
REG_SZ        InstallLocation : (S) C:\Users\Carmine Falcone\AppData\Local\exodus
REG_SZ        Publisher       : (S) Exodus Movement Inc
REG_SZ        QuietUninstallString : (S) &#34;C:\Users\Carmine Falcone\AppData\Local\exodus\Update.exe&#34; --uninstall -s
REG_SZ        UninstallString : (S) &#34;C:\Users\Carmine Falcone\AppData\Local\exodus\Update.exe&#34; --uninstall
REG_SZ        URLUpdateInfo   : (S) 
REG_DWORD     EstimatedSize   : (S) 193279
REG_DWORD     NoModify        : (S) 1
REG_DWORD     NoRepair        : (S) 1
REG_DWORD     Language        : (S) 1033
</code></pre><p>as well we can get it from exodus file installer&rsquo;s prefetch execution time or as well look into mft.</p>
<pre tabindex="0"><code>vol -f Carmine-Falcone.raw windows.mftscan.MFTScan
</code></pre><pre tabindex="0"><code>* 0xab0b0769c920    FILE    89142   2   File    Archive FILE_NAME   2024-01-07 08:39:03.000000  2024-01-07 08:39:03.000000  2024-01-07 08:39:03.000000  2024-01-07 08:39:03.000000  EXODUS-WINDOWS-X64-24.1.1.EXE-5FE34CD7.pf
</code></pre><pre tabindex="0"><code>2024-01-07 08:38:08 UTC+0000 2024-01-07 08:38:32 UTC+0000   2024-01-07 08:38:32 UTC+0000   2024-01-07 08:38:32 UTC+0000   Users\CARMIN~1\DOWNLO~1\exodus-windows-x64-24.1.1.exe
2024-01-07 08:39:03 UTC+0000 2024-01-07 08:39:03 UTC+0000   2024-01-07 08:39:03 UTC+0000   2024-01-07 08:39:03 UTC+0000   Windows\Prefetch\EXODUS-WINDOWS-X64-24.1.1.EXE-5FE34CD7.pf
</code></pre><p>And we can see there is a prefetch entry for the installer which has the time 08:39:03</p>
<pre tabindex="0"><code>Answer5: exodus-2024:01:07:08:39
</code></pre><h4 class="group head-tag" id="question-6">Question 6:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-6"></a></h4><p>Q6) what is the malware that wants to steal the cryptocurrency wallet and ip it&rsquo;s trying to send to with port number?
Format: malware_ip:port)
let&rsquo;s look through the contents of Downloads, Desktop etc. There didn&rsquo;t seem to be anything suspicious present in the downloads folder since all that there was the installers for the applications present in his system. But in desktop folder, there was a services.exe which looked suspicious which also has a execution/run in prefetch files as well as other Evidence of Executions.</p>
<pre tabindex="0"><code>0xab0b0d34fe90	\Users\Carmine Falcone\Desktop\services.exe	216

vol -f Carmine-Falcone.raw windows.dumpfiles.DumpFiles --virtaddr 0xab0b0d34fe90
</code></pre><p>So assuming the ip and port is present in the strings of the binary, I made a quick code snippet find all occurances of ip addresses in the strings.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">strings</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./stealerStrings.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
</span></span></code></pre></div><p>which gives the output,</p>
<p><code>['127.0.0.1', '172.30.145.189']</code>
First one is localhost, hence the second one should be the one we are after.
ding strings grep with the ip, we get the port too.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-4.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<pre tabindex="0"><code>Answer6: services.exe_172.30.145.189:6969
</code></pre><h4 class="group head-tag" id="question-7">Question 7:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-7"></a></h4><p>Q7) Eventhough Falcone&rsquo;s Network Moniter blocked the file sent, falcone made sure to zip with a password and noted it down temporaily in his screen and sent it to a detective for analysis.what is the password of the zip file?</p>
<p>as he noted it down and only notepad.exe was running and as it not get saved as well it&rsquo;s mentioned temporarily, we have to retrieve it from notepad memory.
So let&rsquo;s dump the VAD structures using vaddump vol2 plugin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> vol.py -f Carmine-Falcone.raw --profile<span class="o">=</span>Win10x64_19041 vaddump -p <span class="m">5372</span> -D vaddumps
</span></span></code></pre></div><p>But unless we can pinpoint to the heap dumps in the VAD structures, its going to be hectic to go through the whole process&rsquo;s memory dump. So i used vadtree plugin in vol2 to look at the VAD (Virtual Address Descriptor) tree.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol.py -f Carmine-Falcone.raw --profile<span class="o">=</span>Win10x64_19041 vadtree -p <span class="m">5372</span> --output-file<span class="o">=</span>./vadtree.dot --output<span class="o">=</span>dot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">dot vadtree.dot -Tpng &gt; vadtree.png
</span></span></code></pre></div><p>
  <img
    class="data-image"
    src="vadtree.png"
    alt="alt text"
    loading="lazy" />



  <img
    class="data-image"
    src="./image-5.png"
    alt="alt text"
    loading="lazy" />


here the colours represent</p>
<pre tabindex="0"><code>Red: Heaps
Gray: Dynamic Link Libraries
Green: Stacks
Yellow: Mapped Files
</code></pre><p>We can see there are 4 heaps within the process structure as denoted by the red blocks. We can also achieve the same with volshell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol.py -f Carmine-Falcone.raw --profile<span class="o">=</span>Win10x64_19041 volshell -p <span class="m">5372</span>
</span></span><span class="line"><span class="cl">Volatility Foundation Volatility Framework 2.6.1
</span></span><span class="line"><span class="cl">Current context: notepad.exe @ 0xffffab0b152e8080, <span class="nv">pid</span><span class="o">=</span>5372, <span class="nv">ppid</span><span class="o">=</span><span class="m">4504</span> <span class="nv">DTB</span><span class="o">=</span>0x261a7000
</span></span><span class="line"><span class="cl">Python 2.7.18 <span class="o">(</span>default, Jul  <span class="m">1</span> 2022, 10:30:50<span class="o">)</span> 
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;copyright&#34;</span>, <span class="s2">&#34;credits&#34;</span> or <span class="s2">&#34;license&#34;</span> <span class="k">for</span> more information.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IPython 5.10.0 -- An enhanced Interactive Python.
</span></span><span class="line"><span class="cl">?         -&gt; Introduction and overview of IPython<span class="s1">&#39;s features.
</span></span></span><span class="line"><span class="cl"><span class="s1">%quickref -&gt; Quick reference.
</span></span></span><span class="line"><span class="cl"><span class="s1">help      -&gt; Python&#39;</span>s own <span class="nb">help</span> system.
</span></span><span class="line"><span class="cl">object?   -&gt; Details about <span class="s1">&#39;object&#39;</span>, use <span class="s1">&#39;object??&#39;</span> <span class="k">for</span> extra details.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">In <span class="o">[</span>1<span class="o">]</span>: <span class="nv">process_heaps_address_list</span> <span class="o">=</span> proc<span class="o">()</span>.Peb.ProcessHeaps.dereference<span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">In <span class="o">[</span>2<span class="o">]</span>: process_heaps_address_list
</span></span><span class="line"><span class="cl">Out<span class="o">[</span>2<span class="o">]</span>: &lt;Array 2106693189632,2106691747840,2106719469568,2106720911360&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">In <span class="o">[</span>3<span class="o">]</span>: <span class="k">for</span> i in <span class="o">[</span>2106693189632,2106691747840,2106719469568,2106720911360<span class="o">]</span>:
</span></span><span class="line"><span class="cl">   ...:     print<span class="o">(</span>hex<span class="o">(</span>i<span class="o">))</span>  
</span></span><span class="line"><span class="cl">0x1ea80b30000
</span></span><span class="line"><span class="cl">0x1ea809d0000
</span></span><span class="line"><span class="cl">0x1ea82440000
</span></span><span class="line"><span class="cl">0x1ea825a0000
</span></span></code></pre></div><p>Now that we have the addresses of the heaps, we narrow down our analysing to just the heap dumps.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">strings -e l notepad.exe.4775c080.&lt;address&gt;.dmp
</span></span></code></pre></div><p>3 out of 4 dumps we got didn&rsquo;t contain much information. But while going through the strings of the dump of the address <code>0x000001ea80b30000-0x000001ea80c2ffff</code>, along with other interesting strings, we can find this.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-6.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>And we can confirm its just a whitespace. So now that we have a possible candidate for a password <code>w&amp;31D,%4&gt; C6'nT</code></p>
<p>We can also get this using MemProcFS by looking into the heaps of notepad.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-8.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>


  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-9.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>and as well we can verify this by debugging the memory dump using windbg.</p>
<p>we can get the dmp file of the original raw memory file with mounting the device using memprocfs and then we can use windbg to debug the memory dump.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-7.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>


  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-10.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>


  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-11.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>!process 0 0 notepad.exe command displays detailed information about the notepad.exe
.process /r /p ffffab0b152e8080 command sets the process context to the notepad.exe process with the specified address. The /r option reloads the user-mode symbols for the process, and the /p option specifies a physical address.
After running this command, the debugger’s process context is set to the notepad.exe process, and the user-mode symbols for the process are loaded.</p>
<p>now let&rsquo;s list all heaps using
<code>!heap -s -v -a</code></p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-12.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>we have to look int heaps with extra user_flag</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-13.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>and lets display the heap content using</p>
<pre tabindex="0"><code>db 000001ea80b6ec80 L80
</code></pre>
  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-14.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p><code>w&amp;31D,%4&gt; C6'nT</code>
and we finally find the valid string that could be the noted down one.</p>
<pre tabindex="0"><code>Answer7: 63eeb3a466f8bab52b44e182e919b512
</code></pre><h4 class="group head-tag" id="question-8">Question 8:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-8"></a></h4><p>Q8) what is the hash of the original files in the zip file before the stealer modified them?
Format: sha1sum:sha1sum</p>
<p>now we can either dump the zip file from memory or get it from the handle of 7z.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-15.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>but apparently when we look into the file&rsquo;s hex it is hollowed out eventhough it is a handle to a process, the middle is only null bytes, so we can&rsquo;t extract the file either. dumping it from memory also has the same effect.</p>
<pre tabindex="0"><code>vol.py -f Carmine-Falcone.raw --profile=Win10x64_19041 filescan | grep &#34;Desktop&#34; 
[snip]
0x0000ab0b10a27530  32758      1 R--r-- \Device\HarddiskVolume2\Users\Carmine Falcone\Desktop\Carmine Falcone_2.7z
[snip]
</code></pre><p>so looking into why the file unknown.data is given as well this zip file that is inside the 7z was dropped by the services.exe which is found using timelining, so from the previous question as well as description we can conclude that the unknown.data is the original file that was zipped and sent to the detective it&rsquo;s corrupted</p>
<p>now we can try and fix the file using the hollowed out 7z.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-16.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>fixing both after comparing, we are able to fix the file and extract it using the above obtained password <code>w&amp;31D,%4&gt; C6'nT</code> and we get 2 .seco files.</p>
<p>but as mentioned by the question as well as looking into the timeline as the stealer modified the seco files, lets statically analyse the binary with IDA to fix it as the hash is also verified as wrong.</p>
<p>We can see that it&rsquo;s a PE32+ executable, pretty standard stuff.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-19.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>We get to the start function from which we follow start_0</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-20.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>As it&rsquo;s windows go binary, the offset in line 47 in start_0 should point to the offset of runtime_main.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-21.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>then looking into the runtime_main.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-22.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>we can immediately see that it is loading the path of a file called <code>exodus.wallet</code>, by joining it with an environment variable <code>USERPROFILE</code>.</p>
<p>Then, it&rsquo;s concatenating &ldquo;.zip&rdquo; to the filename which is stored in the environment variable.</p>
<p>Then, it calls a function <code>getFilesInFolder</code> (which I renamed in IDA) after looking at it.</p>
<p><code>getFilesInFolder</code> is defined as follows</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-23.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>Here we can see that it&rsquo;s just walking the entire directory and getting every file in it.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-24.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>After that, it enters a for loop, where first it enters a function (on the right branch of the jump) which first opens and reads the file (which is clear from the assembly)</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-25.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>(Note that the buffer of the file is stored as a pointer inside <code>rdx</code> after the function returns)</p>
<p>Then, once that is done, a function called <code>runtime_makeslice</code> (IDA&rsquo;s renaming convention) is called. This essentially allocates new memory on the heap for a fresh object and initialises its values to 0.</p>
<p>After that, it enters this for loop</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-26.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>Notice how the file&rsquo;s buffer is being stored in <code>esi</code>, then XORed with 0x33, then stored as a pointer inside <code>rax</code>. This is done for the entire length of the buffer (basically the whole file)</p>
<p>Then, again, from the assembly itself, it is pretty clear that this new &ldquo;encrypted&rdquo; buffer (which is just the original file XORed with 0x33), that is then written to a fresh file. This is done for every file in the directory (this is evident also from the fact that the entire directory was previously walked to get every file handle).</p>
<p>After the for loop to encrypt every file, another function (on the left branch of the jump) is called, let&rsquo;s take a look at what it does.</p>
<p>Again, like the previous function, it first opens the file (the encrypted files this time), stats them, creates a zip header, and copies the file content to the zip archive.</p>
<p>After that, we enter this part of the binary</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-27.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>It enters a for loop to remove every encrypted file that was created.</p>
<p>After that, it gets the current working directory of the zip file that was created (containing all the encrypted files).</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-28.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>After that, it initiates a <code>tcp</code> connection to <code>172.30.145.189:6969</code>, to which it sends our zipped archive of the encrypted files.</p>
<p>So the binary itself does something pretty simple overall. It reads every single file in the directory, &ldquo;encrypts&rdquo; it by XORing with 0x33, then zips it and sends it to that IP and port.</p>
<p>Here we can see, the data is begin xored with 0x33, which is also evident when looking back to the .seco files in hex editor where there are a lot of 0x33 bytes present.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-29.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>so wrote a quick script to fix up the .seco files by xoring them with 0x33,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;enc/seed.seco&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">encdata</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">decdata</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">encdata</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">decdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">^</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dec/seed.seco&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">decdata</span><span class="p">)</span>
</span></span></code></pre></div><p>So now i have the fixed both seco files. So taking the sha1 of both the files.</p>
<pre tabindex="0"><code>Answer8: 3ba6011f5e1b6941f893df6579f87f1c823e7493:5e38ffd5e6d6115a6f4bb21b5216c37392eb544f 
</code></pre><h4 class="group head-tag" id="question-9">Question 9:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-9"></a></h4><p>Q9) what is the password that Carmine Falcone protected the wallet with
Format: md5(password)</p>
<p>After doing research, tests and analysis on exodus wallet, we are able to find that the password is stored in plaintext between <code>exodus.wallet%22%2C%22passphrase%22%3A%22</code> and <code>%22%7D</code> in memory. So we can extract the password from the memory dump.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-17.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>so now we got the password as <code>yb%23uO7%26n%25%24%C2%A36%5BE310</code>, converting the url encoded characters to ascii we get <code>yb#uO7&amp;n%$£6[E310</code></p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-18.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>password is <code>yb#uO7&amp;n%$£6[E310</code></p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-31.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<pre tabindex="0"><code>Answer9: 93bbca2406298b9cb574ac06abf113e4
</code></pre><h4 class="group head-tag" id="question-10">Question 10:<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-10"></a></h4><p>Q10) who did Carmine falcone recive money from?
Format: name_person:curreny_used(3 or 4 letter significance):amount(in dollars with precision of 2 decimal places):transaction_id</p>
<p>after transferring the wallet to exodus , we can use the password we found to open the wallet and look into the transactions.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-30.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>let&rsquo;s check the received logs.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-34.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>


  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-35.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>he have received money from Edward Nigma (Riddler) in USD 15.31 with a transaction id of 0xab42fc3fb81fca7bec9e49058d80dc928ed5de2e780a54de41d3c1a8587c4ab7.</p>
<pre tabindex="0"><code>Answer10 edward_nigma:eth:15.31:0xab42fc3fb81fca7bec9e49058d80dc928ed5de2e780a54de41d3c1a8587c4ab7
</code></pre><h4 class="group head-tag" id="question-11">Question 11<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-11"></a></h4><p>Q11) who did Carmine falcone send money to?
Format: name_person:curreny_used(3 or 4 letter significance):amount(in dollars with precision of 2 decimal places):senderaddress</p>
<p>the same way we look into the sent log.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-36.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>He sent the money to Oswald Cobblepot, which was USD 13.65 with a transaction id of 0xab42fc3fb81fca7bec9e49058d80dc928ed5de2e780a54de41d3c1a8587c4ab7 with a  wallet address of 0xcfb6b082B7296FaA5aD18695e1F554AFC23724eD</p>
<pre tabindex="0"><code>Answer11: oswald_cobblepot:eth:13.65:0xcfb6b082B7296FaA5aD18695e1F554AFC23724eD
</code></pre><h4 class="group head-tag" id="question-12">Question 12<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-12"></a></h4><p>Q12) what is the name and client private key that Salvatore asked for contact verification?
Format: infobreakage_dbkey:client_email</p>
<p>Now looking into the email attachment, we have few folders, on analysis we can find that it is dropbox files.</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-37.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>looking into info.json gives that an info from the path that it is either linux or mac .dropbox folder</p>
<p>looking into files, analysing as well after researching, we are able to come across these tools that can give us the required information.</p>
<p>for

<a
  href="https://github.com/dnicolson/dbx-keygen-macos"
  
    target="_blank"
  
  >mac</a
>
 and

<a
  href="https://github.com/newsoft/dbx-keygen-linux"
  
    target="_blank"
  
  >linux</a
>
</p>
<p>but apparently we have to edit it so it can work in our case.</p>
<p>so I made a cpp script to do that.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;openssl/evp.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">DROPBOX_PATH</span> <span class="o">=</span> <span class="s">&#34;/mnt/d/bi0sctf/chall4/dropbox/instance1/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">CLIENT_VEC</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;C&#39;</span><span class="p">,</span> <span class="sc">&#39;l&#39;</span><span class="p">,</span> <span class="sc">&#39;i&#39;</span><span class="p">,</span> <span class="sc">&#39;e&#39;</span><span class="p">,</span> <span class="sc">&#39;n&#39;</span><span class="p">,</span> <span class="sc">&#39;t&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">IV</span> <span class="o">=</span> <span class="p">{</span><span class="mi">108</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">81</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="cp">#define NUM_THREADS 10
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">thread_data</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">version</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">raw_payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">tdata</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;&gt;</span> <span class="n">unpack_payload</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">res1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">res2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">res2</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="o">-</span> <span class="mi">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span> <span class="n">res2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">read_file</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filename</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">ifstream</span> <span class="n">file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">binary</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="p">.</span><span class="n">seekg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="n">tellg</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="p">.</span><span class="n">seekg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">beg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="p">.</span><span class="n">read</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">calculate_md5</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">inode_no</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">str_inode</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">inode_no</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">value</span> <span class="o">=</span> <span class="s">&#34;ia9&#34;</span> <span class="o">+</span> <span class="n">str_inode</span> <span class="o">+</span> <span class="s">&#34;Xa|ui20&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_MD_CTX</span> <span class="o">*</span><span class="n">mdctx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">md5_digest</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">md5_digest_len</span> <span class="o">=</span> <span class="n">EVP_MD_size</span><span class="p">(</span><span class="n">EVP_md5</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// MD5_Init
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">mdctx</span> <span class="o">=</span> <span class="n">EVP_MD_CTX_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_MD_CTX_init</span><span class="p">(</span><span class="n">mdctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_DigestInit_ex</span><span class="p">(</span><span class="n">mdctx</span><span class="p">,</span> <span class="n">EVP_md5</span><span class="p">(),</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// MD5_Update
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">EVP_DigestUpdate</span><span class="p">(</span><span class="n">mdctx</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">value</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// MD5_Final
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">md5_digest</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">OPENSSL_malloc</span><span class="p">(</span><span class="n">md5_digest_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_DigestFinal_ex</span><span class="p">(</span><span class="n">mdctx</span><span class="p">,</span> <span class="n">md5_digest</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">md5_digest_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_MD_CTX_free</span><span class="p">(</span><span class="n">mdctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">md5_digest</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">decrypt_the_payload</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">inode_no</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">outlen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_CIPHER_CTX</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">EVP_CIPHER_CTX_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_CIPHER_CTX_init</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">enc_key</span> <span class="o">=</span> <span class="n">calculate_md5</span><span class="p">(</span><span class="n">inode_no</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">target_message</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">inlen</span> <span class="o">=</span> <span class="n">target_message</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_DecryptInit</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">EVP_aes_128_cbc</span><span class="p">(),</span> <span class="n">enc_key</span><span class="p">,</span> <span class="n">IV</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_DecryptUpdate</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">outlen</span><span class="p">,</span> <span class="n">target_message</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">inlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_DecryptFinal</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="n">data</span><span class="p">()</span><span class="o">+</span><span class="n">outlen</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// bool check(std::vector&lt;uint8_t&gt; first, std::vector&lt;uint8_t&gt; second){
</span></span></span><span class="line"><span class="cl"><span class="c1">//     std::sort(first.begin(), first.end());
</span></span></span><span class="line"><span class="cl"><span class="c1">//     std::cout &lt;&lt; &#34;\nRHA: contains:\n&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1">//     for(int i=0; i&lt;first.size(); i++){
</span></span></span><span class="line"><span class="cl"><span class="c1">//         printf(&#34;%x &#34;, first[i]);
</span></span></span><span class="line"><span class="cl"><span class="c1">//     }
</span></span></span><span class="line"><span class="cl"><span class="c1">//     printf(&#34;\n\n&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1">//     for(int i=0; i&lt;second.size(); i++){
</span></span></span><span class="line"><span class="cl"><span class="c1">//         printf(&#34;%x &#34;, second[i]);
</span></span></span><span class="line"><span class="cl"><span class="c1">//     }
</span></span></span><span class="line"><span class="cl"><span class="c1">//     printf(&#34;\n\n&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1">//     return std::includes(first.begin(), first.end(), second.begin(), second.end());
</span></span></span><span class="line"><span class="cl"><span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">CLIENT_VEC</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">CLIENT_VEC</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">get_versioned_key</span><span class="p">(</span><span class="n">tdata</span> <span class="o">*</span><span class="n">td</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">raw_payload</span> <span class="o">=</span> <span class="n">td</span><span class="o">-&gt;</span><span class="n">raw_payload</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">start</span> <span class="o">=</span> <span class="n">td</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">end</span> <span class="o">=</span> <span class="n">td</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">dec_payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">inode_no</span><span class="o">=</span><span class="n">start</span><span class="p">;</span> <span class="n">inode_no</span><span class="o">&lt;=</span><span class="n">end</span><span class="p">;</span> <span class="n">inode_no</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">dec_payload</span> <span class="o">=</span> <span class="n">decrypt_the_payload</span><span class="p">(</span><span class="n">raw_payload</span><span class="p">,</span> <span class="n">inode_no</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="n">check</span><span class="p">(</span><span class="n">dec_payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="nb">true</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s"> ========================================== </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[+] Key Found !</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[*] Wanted Number: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">inode_no</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n\n</span><span class="s">&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// printf(&#34;result: %d\n&#34;, result);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// for(int i=0;i &lt;CLIENT_VEC.size(); i++){
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//     printf(&#34;%c&#34;, CLIENT_VEC[i]);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[!] Usage: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &lt;start&gt; &lt;end&gt;&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">start</span> <span class="o">=</span> <span class="n">atoll</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint64_t</span> <span class="n">end</span> <span class="o">=</span> <span class="n">atoll</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[*] Range Start: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">start</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[*] Range End: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">end</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">DROPBOX_PATH</span> <span class="o">+</span> <span class="s">&#34;hostkeys&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[*] Reading file: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">filename</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">unpack_payload</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">tdata</span> <span class="n">td</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">td</span><span class="p">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">td</span><span class="p">.</span><span class="n">raw_payload</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">td</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">td</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;[*] Version: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[*] Raw Payload len: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">res</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// std::sort(CLIENT_VEC.begin(), CLIENT_VEC.end());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">flag</span> <span class="o">=</span> <span class="n">get_versioned_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">td</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;[!] Not Found</span><span class="se">\n\n</span><span class="s">&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>and we get the output as</p>

  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-38.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>as well this can be made efficient by</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">NO_OF_PROCESS</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[!] Usage: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &lt;start&gt; &lt;end&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">//</span> <span class="n">NO_OF_PROCESS</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NO_OF_PROCESS</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">rstart</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="n">interval</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rend</span> <span class="o">=</span> <span class="n">rstart</span> <span class="o">+</span> <span class="n">interval</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] Py: Started Process </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> rstart: </span><span class="si">{</span><span class="n">rstart</span><span class="si">}</span><span class="s2"> rend: </span><span class="si">{</span><span class="n">rend</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&#34;./dbx-crack&#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rstart</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">rend</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><p>now we can use this on the tool and get the details, here is what I edited in the tool.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ctypes</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ctypes.util</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hmac</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">simplejson</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">json</span> <span class="k">as</span> <span class="nn">simplejson</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="c1"># requires pip install pbkdf2</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pbkdf2</span> <span class="kn">import</span> <span class="n">PBKDF2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">binascii</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">glob</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BUILD_KEY</span> <span class="o">=</span> <span class="s2">&#34;dropbox&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">CLIENT_KEY_NAME</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;Client&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Taken from common_util/keystore/keystore_posix.py</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: original version is based on ncrypt</span>
</span></span><span class="line"><span class="cl"><span class="c1"># http://pypi.python.org/pypi/ncrypt/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">Crypto</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">crypto</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;Crypto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crypto</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#CIPHER_TYPE = CipherType(&#39;AES-128&#39;, &#39;CBC&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KeyStoreFileBacked</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">appdata_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_appdata_path</span> <span class="o">=</span> <span class="n">appdata_path</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="o">=</span><span class="mi">40370414</span> <span class="c1"># bruteforced uid</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id2s</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_i</span> <span class="o">=</span> <span class="s1">&#39;l</span><span class="se">\x07</span><span class="s1">8</span><span class="se">\x01</span><span class="s1">4$sX</span><span class="se">\x03\xff</span><span class="s1">ri3</span><span class="se">\x13</span><span class="s1">aQ&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x8f\xf4\xf2\xbb\xad\xe9</span><span class="s1">G</span><span class="se">\xea\x1f\xdf</span><span class="s1">im</span><span class="se">\x80</span><span class="s1">[5&gt;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_appdata_path</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;hostkeys&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># simplified version</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">id2s</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;ia9</span><span class="si">%s</span><span class="s1">X&#39;</span> <span class="o">%</span> <span class="n">_id</span> <span class="o">+</span> <span class="s1">&#39;a|ui20&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">obfuscate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">encryptor</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_unobfuscate_low</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">decryptor</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">unobfuscate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unobfuscate_low</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">unversionify_payload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">hmac_keys</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">version</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">version</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hmac_keys</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Parsing error, bad version&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">hm</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">hmac_keys</span><span class="p">[</span><span class="n">version</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">ds</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">digest_size</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ds</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Bad digest size&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">stored_hm</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="n">ds</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="n">ds</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">hm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">hm</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span> <span class="o">!=</span> <span class="n">stored_hm</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Bad digest&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_load_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Overly simplified version</span>
</span></span><span class="line"><span class="cl">        <span class="n">version</span><span class="p">,</span> <span class="n">raw_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unversionify_payload</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span><span class="p">,</span> <span class="n">needs_migrate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unobfuscate</span><span class="p">(</span><span class="n">raw_payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Manually remove AES-CBC padding ...</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[:</span><span class="n">pad</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="o">=</span> <span class="n">simplejson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_load_dict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">decodestring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_versioned_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hmac_keys</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;No Data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unversionify_payload</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hmac_keys</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KeyStore</span><span class="p">(</span><span class="n">KeyStoreFileBacked</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">unique_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">inode</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">st_ino</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;KEYSTORE: unique_id = </span><span class="si">%r</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">inode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">inode</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Version0</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">USER_HMAC_KEY</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\xd1\x14\xa5</span><span class="s1">R</span><span class="se">\x12</span><span class="s1">e_t</span><span class="se">\xbd</span><span class="s1">w.7</span><span class="se">\xe6</span><span class="s1">J</span><span class="se">\xee\x9b</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">APP_KEY</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">c</span><span class="se">\x8c\t</span><span class="s1">.</span><span class="se">\x8b\x82\xfc</span><span class="s1">E(</span><span class="se">\x83\xf9</span><span class="s1">_5[</span><span class="se">\x8e</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">APP_IV</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\xd8\x9b</span><span class="s1">C</span><span class="se">\x1f\xb6\x1d\xde\x1a\xfd\xa4\xb7\xf9\xf4\xb8\r\x05</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">APP_ITER</span> <span class="o">=</span> <span class="mi">1066</span>
</span></span><span class="line"><span class="cl">    <span class="n">USER_KEYLEN</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">    <span class="n">DB_KEYLEN</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">new_user_key_and_hmac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">ks</span><span class="o">.</span><span class="n">get_random_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">USER_KEYLEN</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">USER_HMAC_KEY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_database_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">PBKDF2</span><span class="p">(</span><span class="n">passphrase</span><span class="o">=</span><span class="n">user_key</span><span class="p">,</span> <span class="n">salt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">APP_KEY</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">APP_ITER</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_KEYLEN</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">DBKeyStore</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">appdata_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">parsers</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">Version0</span><span class="p">()}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">hmac_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsers</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">USER_HMAC_KEY</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsers</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="n">KeyStore</span><span class="p">(</span><span class="n">appdata_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># simplified version</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ...</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_user_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">version</span><span class="p">,</span> <span class="n">user_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">get_versioned_key</span><span class="p">(</span><span class="n">CLIENT_KEY_NAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmac_keys</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Original displays dropbox_hash() instead</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;KEYSTORE: got user key (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">user_key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">user_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">appdata_path</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;/mnt/d/bi0sctf/chall4/dropbox/instance1/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dbks</span> <span class="o">=</span> <span class="n">DBKeyStore</span><span class="p">(</span><span class="n">appdata_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">user_key</span> <span class="o">=</span> <span class="n">dbks</span><span class="o">.</span><span class="n">get_user_key</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="s2">&#34;User key: &#34;</span><span class="p">,</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span> <span class="n">user_key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">v0</span> <span class="o">=</span> <span class="n">Version0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">db_key</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">get_database_key</span><span class="p">(</span><span class="n">user_key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="s2">&#34;Database key: &#34;</span><span class="p">,</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span> <span class="n">db_key</span> <span class="p">)</span>
</span></span></code></pre></div>
  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-39.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<pre tabindex="0"><code>KEYSTORE: got user key (0, e747b9c8cc2f80b88c6b511f26682b66)
User key:  e747b9c8cc2f80b88c6b511f26682b66
Database key:  89839f76862bd89b369d99f41ca51cd7
</code></pre><p>so <code>dbkey: 89839f76862bd89b369d99f41ca51cd7</code></p>
<p>now we can use this 
<a
  href="https://github.com/newsoft/sqlite3-dbx"
  
    target="_blank"
  
  >tool</a
>
 to decrypt and view the dbx file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sqlite -key b7b04158ee71df20a80d1a70113798c1 &lt;path to config.dbx&gt;
</span></span></code></pre></div>
  <figure class="data-image-info ">
    <img
      class="data-image"
      src="./image-40.png"
      alt="alt text"
      loading="lazy" />
    <figcaption></figcaption>
  </figure>

<p>from which we can get the required information that is:</p>
<pre tabindex="0"><code>client email :twoface2681988@gmail.com
client name  :Harvey Dent
private_key:MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgJGmnt3gVtSX2iswJYf9S3I5X4vPaS1xKHAvFdN5A2tWhRANCAASO63HNoO6rpC9Gfpi5tR+F5kEiRoTzbV/xWscN9McLCTlj2gWtZ+LSrkQkuaO5/XYiHXxCF/1vRWuNspXwY/K9
</code></pre><pre tabindex="0"><code>Answer12: 89839f76862bd89b369d99f41ca51cd7:twoface2681988@gmail.com
</code></pre><h4 class="group head-tag" id="question-13">Question 13<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-13"></a></h4><p>Q13) what is the information interpreted further from previous question
Format: name_client:private_key</p>
<p>so we can answer this from the above analysis</p>
<pre tabindex="0"><code>Answer13: harvey_dent:MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgJGmnt3gVtSX2iswJYf9S3I5X4vPaS1xKHAvFdN5A2tWhRANCAASO63HNoO6rpC9Gfpi5tR+F5kEiRoTzbV/xWscN9McLCTlj2gWtZ+LSrkQkuaO5/XYiHXxCF/1vRWuNspXwY/K9
</code></pre><h4 class="group head-tag" id="question-14">Question 14<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#question-14"></a></h4><p>Q14) what is the userkey of the encrypted dbx database?
Format: userkey

  <img
    class="data-image"
    src="./image-41.png"
    alt="alt text"
    loading="lazy" />

</p>
<p><code>userkey:e747b9c8cc2f80b88c6b511f26682b66</code></p>
<pre tabindex="0"><code>Answer14 : e747b9c8cc2f80b88c6b511f26682b66
</code></pre><p>and after this, we finally finish the Adventure! and yeah we made Batman uncover the most underground corruption that was happening in Gotham.</p>
<h3 class="group head-tag" id="flag">flag<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#flag"></a></h3><pre tabindex="0"><code>bi0sctf{b4tm4n_und3rgr0und_inv3st1g4t10n_Succ3ssful_f98a12405d41746836bb4e7df69e44f6}
</code></pre><h2 class="group head-tag" id="closing-note">Closing Note<a data-title-of-head class="group-hover:after:content-['__#'] no-underline hover:text-blue-700" href="#closing-note"></a></h2><p>Thank you to everyone who tried the challenge. We thank you for playing the CTF and would love to hear some feedback about the challenge.
If you have any queries regarding the challenge, feel free to hit me up over twitter/discord.</p>
<p><strong>Contact</strong>: Azr43lKn1ght | 
<a
  href="https://twitter.com/Azr43lKn1ght"
  
    target="_blank"
  
  >twitter</a
>
 | 
<a
  href="https://www.linkedin.com/in/azr43lkn1ght?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=android_app"
  
    target="_blank"
  
  >Linkedin</a
>
 | 
<a
  href="https://github.com/Azr43lKn1ght"
  
    target="_blank"
  
  >github</a
>
</p>

        </div>

        
        <div
          class="flex flex-col justify-start px-1 pb-5 pt-1 md:px-3 lg:flex-row lg:justify-between lg:px-10">
          
          
          
            <div class="flex flex-row flex-wrap items-center">
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/bi0sctf2024/"
                  >Bi0sctf2024</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/memory-forensics/"
                  >Memory Forensics</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/incident-response/"
                  >Incident Response</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/malware-analysis/"
                  >Malware Analysis</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/blockchain-forensics/"
                  >Blockchain Forensics</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/password-retrieval/"
                  >Password Retrieval</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/windbg-dump-debugging/"
                  >WinDBG Dump Debugging</a
                >
              
                <a
                  class="mx-1 my-0.5 rounded-lg border border-gray-200 px-1.5 py-1 text-center text-xs text-gray-600 hover:bg-gray-100 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-600"
                  href="http://localhost:1313/tags/mac-artefact-analysis/"
                  >MAC Artefact Analysis</a
                >
              
            </div>
          

        </div>
      </div>
    </div>

    
    
  </div>
<div data-dial-init class="group fixed bottom-24 end-8 md:end-20">
  <div
    id="speed-dial-menu-bottom-right"
    class="mb-4 flex hidden flex-col items-center space-y-2">
    
    
      <button
        id="to-top-button"
        type="button"
        data-tooltip-target="tooltip-top"
        data-tooltip-placement="left"
        class="flex hidden h-[52px] w-[52px] items-center justify-center rounded-full border border-gray-200 bg-white text-gray-500 shadow-sm hover:bg-gray-50 hover:text-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-400">
        <svg
          class="h-5 w-5"
          aria-hidden="true"
          fill="currentColor"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M629.333333 853.333333h-234.666666c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h234.666666c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32zM842.666667 360.533333L535.466667 113.066667c-12.8-8.533333-27.733333-8.533333-40.533334 0L183.466667 360.533333c-6.4 6.4-12.8 14.933333-12.8 23.466667 0 2.133333 0 6.4 2.133333 8.533333 2.133333 12.8 14.933333 21.333333 27.733333 21.333334h155.733334v236.8c0 19.2 12.8 29.866667 32 29.866666h249.6c21.333333 0 34.133333-12.8 34.133333-29.866666v-234.666667h151.466667c12.8 0 25.6-8.533333 27.733333-21.333333s0-25.6-8.533333-34.133334zM629.333333 746.666667h-234.666666c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h234.666666c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z"></path>
        </svg>
        <span class="sr-only">Top</span>
      </button>
      <div
        id="tooltip-top"
        role="tooltip"
        class="tooltip invisible absolute z-10 inline-block w-auto rounded-lg bg-gray-900 px-3 py-2 text-sm font-medium text-white opacity-0 shadow-sm transition-opacity duration-300 dark:bg-gray-700">
        Top
        <div class="tooltip-arrow" data-popper-arrow></div>
      </div>
    

    
      
      <button
        type="button"
        data-tooltip-target="tooltip-toc"
        data-tooltip-placement="left"
        data-drawer-target="drawer-body-scrolling-toc"
        data-drawer-show="drawer-body-scrolling-toc"
        data-drawer-body-scrolling="true"
        aria-controls="drawer-body-scrolling-toc"
        class="flex h-[52px] w-[52px] items-center justify-center rounded-full border border-gray-200 bg-white text-gray-500 shadow-sm hover:bg-gray-50 hover:text-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-400">
        <svg
          class="h-5 w-5"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          viewBox="0 0 1024 1024"
          version="1.1">
          <path
            d="M901.8 313.5H354.4c-32 0-58.2-26.2-58.2-58.2v-18.1c0-32 26.2-58.2 58.2-58.2h547.4c32 0 58.2 26.2 58.2 58.2v18.1c0 32-26.2 58.2-58.2 58.2z"></path>
          <path
            d="M131.3 246.2m-67.3 0a67.3 67.3 0 1 0 134.6 0 67.3 67.3 0 1 0-134.6 0Z"></path>
          <path
            d="M901.8 579.3H354.4c-32 0-58.2-26.2-58.2-58.2V503c0-32 26.2-58.2 58.2-58.2h547.4c32 0 58.2 26.2 58.2 58.2v18.1c0 32-26.2 58.2-58.2 58.2z"></path>
          <path
            d="M131.3 512m-67.3 0a67.3 67.3 0 1 0 134.6 0 67.3 67.3 0 1 0-134.6 0Z"></path>
          <path
            d="M901.8 845.1H354.4c-32 0-58.2-26.2-58.2-58.2v-18.1c0-32 26.2-58.2 58.2-58.2h547.4c32 0 58.2 26.2 58.2 58.2v18.1c0 32-26.2 58.2-58.2 58.2z"></path>
          <path
            d="M131.3 777.8m-67.3 0a67.3 67.3 0 1 0 134.6 0 67.3 67.3 0 1 0-134.6 0Z"></path>
        </svg>

        <span class="sr-only">Catelog</span>
      </button>
      <div
        id="tooltip-toc"
        role="tooltip"
        class="tooltip invisible absolute z-10 inline-block w-auto rounded-lg bg-gray-900 px-3 py-2 text-sm font-medium text-white opacity-0 shadow-sm transition-opacity duration-300 dark:bg-gray-700">
        Catelog
        <div class="tooltip-arrow" data-popper-arrow></div>
      </div>

      
      
    


    
    <button
      type="button"
      data-drawer-target="drawer-body-scrolling"
      data-drawer-show="drawer-body-scrolling"
      data-drawer-body-scrolling="true"
      aria-controls="drawer-body-scrolling"
      data-tooltip-target="tooltip-tags"
      data-tooltip-placement="left"
      class="flex h-[52px] w-[52px] items-center justify-center rounded-full border border-gray-200 bg-white text-gray-500 shadow-sm hover:bg-gray-50 hover:text-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-400">
      <svg
        class="h-5 w-5"
        aria-hidden="true"
        fill="currentColor"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg">
        <path
          d="M96.512 454.272h839.84a78.752 78.752 0 0 1 78.752 78.752v8.704a78.752 78.752 0 0 1-78.752 78.752H96.512a78.752 78.752 0 0 1-78.752-78.752v-8.704a78.752 78.752 0 0 1 78.752-78.752zM571.872 232.672H904.32a55.424 55.424 0 0 1 0 110.848H571.872a55.424 55.424 0 0 1 0-110.848zM350.208 731.36h332.448a55.424 55.424 0 0 1 0 110.848H350.208a55.424 55.424 0 0 1 0-110.848zM128.544 177.248h221.664a55.424 55.424 0 0 1 0 110.848H128.544a55.424 55.424 0 0 1 0-110.848z"
          p-id="22696"></path>
      </svg>
      <span class="sr-only">Tags</span>
    </button>
    <div
      id="tooltip-tags"
      role="tooltip"
      class="tooltip invisible absolute z-10 inline-block w-auto rounded-lg bg-gray-900 px-3 py-2 text-sm font-medium text-white opacity-0 shadow-sm transition-opacity duration-300 dark:bg-gray-700">
      Tags
      <div class="tooltip-arrow" data-popper-arrow></div>
    </div>

    
    
      <button
        id="to-bottom-button"
        type="button"
        data-tooltip-target="tooltip-bottom"
        data-tooltip-placement="left"
        class="flex h-[52px] w-[52px] items-center justify-center rounded-full border border-gray-200 bg-white text-gray-500 shadow-sm hover:bg-gray-50 hover:text-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-400">
        <svg
          class="h-5 w-5"
          aria-hidden="true"
          fill="currentColor"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M635.733333 341.333333c19.2 0 32 12.8 32 29.866667v236.8h155.733334c12.8 0 25.6 8.533333 27.733333 21.333333 2.133333 4.266667 2.133333 6.4 2.133333 10.666667 0 8.533333-6.4 19.2-12.8 25.6L529.066667 910.933333c-12.8 8.533333-27.733333 8.533333-40.533334 0L181.333333 663.466667c-8.533333-8.533333-12.8-21.333333-8.533333-34.133334 2.133333-12.8 14.933333-21.333333 27.733333-21.333333h151.466667V371.2c0-19.2 12.8-29.866667 34.133333-29.866667h249.6z m-6.4-128c17.066667 0 32 14.933333 32 32s-14.933333 32-32 32h-234.666666c-17.066667 0-32-14.933333-32-32s14.933333-32 32-32h234.666666z m0-106.666666c17.066667 0 32 14.933333 32 32S646.4 170.666667 629.333333 170.666667h-234.666666c-17.066667 0-32-14.933333-32-32S377.6 106.666667 394.666667 106.666667h234.666666z"></path>
        </svg>
        <span class="sr-only">Bottom</span>
      </button>
      <div
        id="tooltip-bottom"
        role="tooltip"
        class="tooltip invisible absolute z-10 inline-block w-auto rounded-lg bg-gray-900 px-3 py-2 text-sm font-medium text-white opacity-0 shadow-sm transition-opacity duration-300 dark:bg-gray-700">
        Bottom
        <div class="tooltip-arrow" data-popper-arrow></div>
      </div>
    
  </div>

  <button
    type="button"
    data-dial-toggle="speed-dial-menu-bottom-right"
    aria-controls="speed-dial-menu-bottom-right"
    aria-expanded="false"
    class="flex h-14 w-14 items-center justify-center rounded-full bg-primary text-white hover:bg-primary700 focus:outline-none focus:ring-4 focus:ring-primary dark:bg-primary dark:hover:bg-primary700 dark:focus:ring-primary700">
    <svg
      class="h-5 w-5 transition-transform group-hover:rotate-45"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 18 18">
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 1v16M1 9h16" />
    </svg>
    <span class="sr-only">Open actions menu</span>
  </button>
</div>
<div
  id="drawer-body-scrolling"
  class="fixed left-0 top-0 z-40 h-screen w-64 -translate-x-full overflow-y-auto bg-white p-4 transition-transform md:w-80 lg:w-96 dark:bg-gray-800"
  tabindex="-1"
  aria-labelledby="drawer-body-scrolling-label">
  <h5
    id="drawer-body-scrolling-label"
    class="text-base font-semibold uppercase text-gray-500 dark:text-gray-400">
    TAGS
  </h5>
  <button
    type="button"
    data-drawer-hide="drawer-body-scrolling"
    aria-controls="drawer-body-scrolling"
    class="absolute end-2.5 top-2.5 inline-flex h-8 w-8 items-center justify-center rounded-lg bg-transparent text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white">
    <svg
      class="h-3 w-3"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 14 14">
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
    </svg>
    <span class="sr-only">Close tags</span>
  </button>

  <div class="overflow-y-auto py-3">
    <div class="flex flex-wrap justify-center gap-2 p-3">
      
        <a
          href="http://localhost:1313/tags/bi0sctf/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Bi0sCTF</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >3</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/bi0sctf2024/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Bi0sctf2024</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/blockchain-forensics/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Blockchain Forensics</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/browser-forensics/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Browser Forensics</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/dfir/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">DFIR</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/file-forensics/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">File Forensics</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/incident-response/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Incident Response</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >4</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/mac-artefact-analysis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">MAC Artefact Analysis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/malware/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Malware</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/malware-analyis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Malware Analyis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/malware-analysis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Malware Analysis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >4</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/malware-development/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Malware Development</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/memory-forensics/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Memory Forensics</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/password-retrieval/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Password Retrieval</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/process-memory-analysis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Process Memory Analysis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/ransomware/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Ransomware</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/ransomware-analysis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Ransomware Analysis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/ransomware-investigation/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Ransomware Investigation</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/ransomware-investigtion/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Ransomware Investigtion</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/ransomware-recovery/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Ransomware Recovery</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/reverse-engineering/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Reverse Engineering</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/rootkit-analysis/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Rootkit Analysis</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >1</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/threat-hunting/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Threat Hunting</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >3</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/windbg-dump-debugging/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">WinDBG Dump Debugging</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >3</span
          >
        </a>
      
        <a
          href="http://localhost:1313/tags/windows-forensics/"
          class="group flex items-center rounded-lg border p-2 text-xs text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
          <span class="flex-1 whitespace-nowrap">Windows Forensics</span>
          <span
            class="ms-2 inline-flex h-2 w-2 items-center justify-center rounded-full bg-blue-100 p-2 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-300"
            >2</span
          >
        </a>
      
    </div>
  </div>
</div>

<div
  id="drawer-body-scrolling-toc"
  class="fixed left-0 top-0 z-40 h-screen w-64 -translate-x-full overflow-y-auto bg-white p-4 transition-transform dark:bg-gray-800 md:w-80 lg:w-96"
  tabindex="-1"
  aria-labelledby="drawer-body-scrolling-toc-label">
  <h5
    id="drawer-body-scrolling-toc-label"
    class="text-base font-semibold text-gray-500 dark:text-gray-400">
    On this page
  </h5>
  <button
    type="button"
    data-drawer-hide="drawer-body-scrolling-toc"
    aria-controls="drawer-body-scrolling-toc"
    class="absolute end-2.5 top-2.5 inline-flex h-8 w-8 items-center justify-center rounded-lg bg-transparent text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white">
    <svg
      class="h-3 w-3"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 14 14">
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
    </svg>
    <span class="sr-only">Close menu</span>
  </button>
  <div class="overflow-y-auto py-4">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#challenge-description">Challenge Description</a></li>
        <li><a href="#solution">Solution</a></li>
        <li><a href="#flag">flag</a></li>
      </ul>
    </li>
    <li><a href="#closing-note">Closing Note</a></li>
  </ul>
</nav>
  </div>
</div>



<script type="module" src="/js/to-top-or-bottom.js"></script>





    
<div
  id="search-overlay"
  class="fixed inset-0 z-50 hidden bg-gray-900/90 backdrop-blur-lg dark:bg-gray-900/80"></div>
<section id="search-section" class="z-50 flex hidden h-dvh w-full flex-col">
  
  <div
    class="flex h-dvh w-full flex-col overflow-auto md:mx-auto md:w-2/3 lg:max-w-2xl">
    
    <div
      id="searchBoxDiv"
      class="sticky top-[-88px] z-50 flex flex-row justify-between px-8 pt-[88px]">
      <div id="searchBox" class="my-6 flex w-full flex-row items-center"></div>
    </div>

    
    <div class="h-[30rem] overflow-auto">
      <div id="searchResults" class="my-3 px-6"></div>
      <div
        id="NotSearchResults"
        class="hidden flex-col items-center justify-around space-y-4 px-6 py-10">
        <p class="font-Oswald text-lg font-bold tracking-wide text-gray-500">
          No search content
        </p>
      </div>
      <div
        id="searchError"
        class="hidden flex-col items-center justify-around space-y-4 px-6 py-10 text-center ">
        <p class="font-Oswald text-lg font-bold text-red-500">
          Oop ! Error occur ...
        </p>
      </div>
      <div
        id="searchLoading"
        class="hidden flex-col items-center justify-around px-6 py-10">
        <svg
          t="1689331200868"
          class="icon animate-spin"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="51409"
          width="128"
          height="128">
          <path
            d="M512 170.666667v85.333333a256 256 0 1 1-223.573333 131.2L213.930667 345.6A341.333333 341.333333 0 1 0 512 170.666667z"
            fill="#bfbfbf"
            opacity=".3"
            p-id="51410"></path>
        </svg>
      </div>
    </div>
  </div>
  
  <div
    class="bottom-0 flex flex-col items-center justify-center space-y-2 py-8 font-Oswald text-xs font-bold text-gray-600">
    <div class="hidden md:block">Press ESC to cancle</div>
    <div class="flex items-center">
      <span class="">Powered by &nbsp;</span>
      <img src="/images/default/algolia-logo.svg" alt="" class="h-4" />
    </div>
  </div>
</section>

<script
  src="https://cdn.jsdelivr.net/npm/algoliasearch@4.17.2/dist/algoliasearch-lite.umd.js"
  integrity="sha256-X2G+vjV8i6Jj2NSGFTvy6Z4q2AlmF5aH0HiIpWJ8eU4="
  crossorigin="anonymous"></script>
<script
  src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.56.3/dist/instantsearch.production.min.js"
  integrity="sha256-mWvjWAfZylKMOg+S3HLq+wng1HHRnl2Idr2r8NsUzIU="
  crossorigin="anonymous"></script>








<script src="/js/search.js"></script>
<footer
  class="mx-auto flex w-full max-w-screen-xl flex-col-reverse items-center gap-y-3 border-t border-gray-200 py-6 md:px-12 lg:flex-row lg:justify-between dark:border-gray-700">
  
  <div
    class="flex flex-col items-center justify-between space-y-3 text-xs text-gray-400 lg:items-start dark:text-gray-500">
    
    <div class="items-center font-Montserrat font-light">
      &copy;
      
      
      
        2024
      

      azr43lkn1ght. All Rights Reserved
    </div>
  </div>

  
  <div
    class="mt-4 flex space-x-5 sm:justify-center md:mt-0 rtl:space-x-reverse">
    
      
        <a
          href="mailto:nithinchenthur@gmail.com"
          class="text-gray-400 hover:text-gray-900 dark:hover:text-white">
          <svg
            class="h-4 w-4"
            aria-hidden="true"
            fill="currentColor"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M513 583.8l448.5-448.5c-11.6-4.7-24.3-7.3-37.5-7.3H100c-12.7 0-24.9 2.4-36.1 6.7L513 583.8z"
              p-id="88208"></path>
            <path
              d="M513 674.3L14.6 175.9C5.3 191.1 0 208.9 0 228v568c0 55.2 44.8 100 100 100h824c55.2 0 100-44.8 100-100V228c0-18.5-5.1-35.9-13.9-50.8L513 674.3z"
              p-id="88209"></path>
          </svg>
          <span class="sr-only">Email page</span>
        </a>
      
      

      

      

      
    
      
      

      

      
        <a
          href="https://github.com/Azr43lKn1ght"
          class="text-gray-400 hover:text-gray-900 dark:hover:text-white">
          <svg
            class="h-4 w-4"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z"
              clip-rule="evenodd" />
          </svg>
          <span class="sr-only">GitHub account</span>
        </a>
      

      
    
      
      

      
        <a
          href="https://twitter.com/Azr43lKn1ght"
          class="text-gray-400 hover:text-gray-900 dark:hover:text-white">
          <svg
            class="h-4 w-4"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 20 20">
            <path
              fill="currentColor"
              d="M12.186 8.672 18.743.947h-2.927l-5.005 5.9-4.44-5.9H0l7.434 9.876-6.986 8.23h2.927l5.434-6.4 4.82 6.4H20L12.186 8.672Zm-2.267 2.671L8.544 9.515 3.2 2.42h2.2l4.312 5.719 1.375 1.828 5.731 7.613h-2.2l-4.699-6.237Z" />
          </svg>

          <span class="sr-only">X page</span>
        </a>
      

      

      
    

    
    

  </div>
</footer>

<script>
  var matches = document.querySelectorAll("button[data-popover-target]");
  for (var i = 0; i < matches.length; i++) {
    let id = matches[i].getAttribute("data-popover-target");

    matches[i].addEventListener("mouseenter", function () {
      document.getElementById(id).classList.remove("hidden");
    });

    matches[i].addEventListener("mouseleave", function () {
      document.getElementById(id).classList.add("hidden");
    });
  }
</script>


<script src="/js/dark-mode.js" defer></script>

  
    
    
    <script src="/js/toc.js"></script>
  

  

  
  
  <script src="/js/zoom-img.js" defer></script>

  
  
  <script src="/js/link-to-top.js" defer></script>

  
    
    
    <script src="/js/code-copy.js" defer></script>
  

  <script
    data-goatcounter="https://seven-demo.goatcounter.com/count"
    async
    src="//gc.zgo.at/count.js"></script>

<script>
      document.querySelectorAll('pre > code').forEach((codeblock) => {
        codeblock.style = "font-size: large !important;";
      });
    </script>
  </body>
</html>
