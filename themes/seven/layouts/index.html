{{ define "main" }}
  <section class="mt-22 flex w-full grow md:mt-38">
    {{ $allPages := .Site.Pages }}
    {{ with .Site.Params.home.showContentTypes }}
      {{ $allPages = where $allPages "Type" "in" . }}
    {{ end }}
    {{ $lastestPosts := first 4 (where $allPages "IsPage" true) }}
    {{ $lastestPostsNums := len $lastestPosts }}


    <div
      class="mx-auto flex max-w-screen-xl flex-col space-y-6 bg-white px-2 pb-5 md:grow md:flex-row md:justify-between md:gap-8 md:space-y-0 md:p-0 dark:bg-[#1b1f26] overflow-hidden">

      {{/* About Me */}}

      <div class="pt-10">
        <div class="shadow-2xl rounded-2xl md:fixed md:max-w-[400px] mx-3 md:mx-0" style="background-color: var(--waline-bgcolor-light)">
            <img
                    src="https://i.gifer.com/LoYt.gif"
                    alt="cover-image" class="w-full aspect-[16/7] object-cover rounded-t-2xl" />
            <img
                    src="https://raw.githubusercontent.com/Azr43lKn1ght/Azr43lKn1ght/main/h3LL.png"
                    alt="avatar" class="w-28 h-28 rounded-full -mt-10 mx-auto" />
            <div>
              <h1 class="text-center text-3xl font-bold mt-4 font-mono" style="color: #00adb5;">Azr43lkn1ght</h1>
                <p class="text-center text text-gray-500 dark:text-white px-4">
                  Team Lead at bi0s, Digital Forensics and Incident Response, Malware Analysis and Development, CTFs and Threat hunting 
                </p>
            </div>
            <div class="flex justify-center space-x-4 mt-4 pb-6">
                <a href="https://github.com/Azr43lKn1ght" class="text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
                </a>
                <a href="https://twitter.com/Azr43lKn1ght" class="text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400">
                  <svg xmlns="http://www.w3.org/2000/svg" x="100px" y="100px" width="24" height="24" viewBox="0 0 50 50">
                    <path fill="#9ca3af" d="M 6.9199219 6 L 21.136719 26.726562 L 6.2285156 44 L 9.40625 44 L 22.544922 28.777344 L 32.986328 44 L 43 44 L 28.123047 22.3125 L 42.203125 6 L 39.027344 6 L 26.716797 20.261719 L 16.933594 6 L 6.9199219 6 z"></path>
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/azr43lkn1ght" class="text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400">
                  <svg xmlns="http://www.w3.org/2000/svg" x="100px" y="100px" width="25" height="25" viewBox="0 0 30 30">
                    <path fill="#9ca3af" d="M9,25H4V10h5V25z M6.501,8C5.118,8,4,6.879,4,5.499S5.12,3,6.501,3C7.879,3,9,4.121,9,5.499C9,6.879,7.879,8,6.501,8z M27,25h-4.807v-7.3c0-1.741-0.033-3.98-2.499-3.98c-2.503,0-2.888,1.896-2.888,3.854V25H12V9.989h4.614v2.051h0.065 c0.642-1.18,2.211-2.424,4.551-2.424c4.87,0,5.77,3.109,5.77,7.151C27,16.767,27,25,27,25z"></path>
                </svg>
                </a>
                <a href="mailto:nithinchenthur@gmail.com" class="text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                </a>
            </div>
        </div>
      </div>

      {{/* Content */}}
      <div class="overflow-auto flex flex-col gap-4">
      {{ range $idx, $post := $lastestPosts }}
        {{ $idx = add $idx 1 }}
        <div
          id="content-home-{{ $idx }}"
          aria-labelledby="content-home-{{ $idx }}"
          class="mx-3 flex flex-col rounded-lg shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] md:mx-0 md:w-5/6 md:flex-row md:border md:border-none md:border-gray-200 md:shadow-none dark:border-gray-600">
          <div
            class="flex h-full flex-col-reverse md:w-full max-w-[700px] md:flex-col md:justify-center md:border-b md:border-gray-200 md:p-2 md:dark:border-gray-700 md:pb-[60px]">
            <p
              class="mt-6 hidden py-3 font-Oswald text-sm font-medium tracking-wide text-gray-500/90 md:block dark:text-gray-500">
              {{ $post.Date.Format "January 2 2006" }}
              <span class="text-primary">/</span>
              {{ index $post.Params.categories 0 }}
            </p>

            <div
              class="px-6 pt-6 pb-3 text-2xl font-extrabold tracking-wide hover:text-[#00adb5] md:px-0 md:py-8 lg:text-6xl dark:text-white">
              <a href="{{ $post.Permalink }}">{{ $post.Title }}</a>
            </div>

            <div class="shrink-0 overflow-hidden md:mt-1">
              {{ $image := resources.Get $post.Params.image }}
              {{ with $image }}
                <a href="{{ $post.Permalink }}">
                <img
                  class="h-60 w-full rounded-t-lg object-cover md:h-80 md:rounded-none md:hover:scale-110 md:hover:brightness-75 md:hover:transition-transform md:hover:duration-700"
                  class="h-60 w-full rounded-t-lg object-cover md:h-80 md:rounded-none md:hover:scale-110 md:hover:brightness-75 md:hover:transition-transform md:hover:duration-700"
                  src="{{ .Permalink }}"
                  alt="preview image"
                  srcset="" />
                </a>
              {{ else }}
                <div class="h-60 w-full md:h-80">
                  {{- partial "random_feature_img.html" . -}}
                </div>
              {{ end }}
            </div>
          </div>
        </div>
      {{ end }}
      </div>
    </div>
  </section>
{{ end }}

{{ define "script" }}
  <script>
    let tabs = document.querySelectorAll("[data-tab-target]");
    let activedTab = getActivedTab();
    let oldContentId = null;

    init();

    tabs.forEach((tab) => {
      tab.addEventListener("click", function () {
        activedTab = getActivedTab();
        if (activedTab === this.id) return;

        // 隐藏旧tab的内容
        setTabAriaSelected(activedTab, "false");
        oldContentId = document.getElementById(activedTab).dataset.tabTarget;
        // addHiddenClass(oldContentId);

        // 显示新tab的内容
        setActivedTab(this.id);
        setTabAriaSelected(this.id, "true");
        // removeHiddenClass(this.dataset.tabTarget);
      });
    });

    function init() {
      if (!activedTab) {
        activedTab = "home-1";
        setActivedTab(activedTab);
      }

      setTabAriaSelected(activedTab, "true");
      removeHiddenClass(document.getElementById(activedTab).dataset.tabTarget);
    }

    // 获取activedTab值
    function getActivedTab() {
      return localStorage.getItem("activedTab");
    }

    // 设置activedTab值
    function setActivedTab(tabId) {
      localStorage.setItem("activedTab", tabId);
    }

    // 设置tab的aria-selected
    function setTabAriaSelected(tabId, value) {
      document.getElementById(tabId).setAttribute("aria-selected", value);
    }

    // 隐藏内容
    function addHiddenClass(contentID) {
      document.getElementById(contentID).classList.add("md:hidden");
    }

    // 显示内容
    function removeHiddenClass(contentID) {
      document.getElementById(contentID).classList.remove("md:hidden");
    }
  </script>
{{ end }}
